<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <!--Utilizamos estas etiquetas a continuación para lograr una página responsive-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="./css/style.css">

    <title>Foro</title>
</head>

<body>
     <!-- Comienzo encabezado -->

     <header id="header">

        <div class="div-lista-header">
            <ul>
                <li><a href="index.html"> HOME </a></li>

                <li><a href="foro.html"> FORO </a></li>
            </ul>
        </div>
    </header>
    <!-- Fin encabezado-->


    <!-- Contenido de la página del foro -->
    <h1>Formulario de Comentarios</h1>
    <br>

    <br>

    <div style="text-align: center;">

        <form id="formularioComentarios">
            <label for="pelicula">Selecciona una película:</label>
            <select id="pelicula" name="pelicula" required></select>

            <br>
            <br>

            <label for="comentario">Comentario (0-200 caracteres):</label>
            <textarea id="comentario" name="comentario" rows="4" maxlength="200" required></textarea>

            <label for="puntaje">Seleccione un puntaje:</label>
            <select id="puntaje" name="puntaje" required></select>
            <br>

            <button type="button" id="enviarComentario">Enviar</button>
            <button type="button" id="verComentario">Ver Comentarios</button>
        </form>

        <!-- Lista de comentarios -->
        <br>

        <h2>Comentarios Previos</h2>
        <div id="listaComentarios" class="comentarios-container"></div>
        

    </div>


    <!--------------------------------------Comienzo footer -------------------------------------->
    <footer>

        <div class="div-logo-footer">
            <img class="tmdb" src="./img/tmdb.png" alt="TMDB logo">
        </div>

    </footer>
    <!--------------------------------------Fin del footer-------------------------------------->

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1031.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aws-sdk/2.1031.0/aws-sdk.min.js"></script>
    <script src="./js/foro.js"></script>
    <script >
//       function verificarAutenticacion(event) {
//   // Evitar que el enlace se abra de inmediato
//   event.preventDefault();
  
//   var urlParams = new URLSearchParams(window.location.search);
//   var authorizationCode = urlParams.get('code');
//   console.log('Codigo: ',authorizationCode)

//   var authenticationData = {
//     ClientId: '7vel4nc12cbipbvn366jdbc1h1',
//     RedirectUri: 'https://d1i2ps8v0vw7sh.cloudfront.net/foro.html',
//     Code: authorizationCode,
// };

// var authenticationDetails = new AWS.AmazonCognitoIdentity.AuthenticationDetails(authenticationData);

// var poolData = {
//     UserPoolId: 'us-east-1_zh8H4WxGm',
//     ClientId: '7vel4nc12cbipbvn366jdbc1h1',
// };

// var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
// console.log(userPool)

// // var userData = {
// //     Username: 'username',  // This can be obtained from the authentication process
// //     Pool: userPool,
// // };

// // var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);

// // cognitoUser.authenticateUser(authenticationDetails, {
// //     onSuccess: function (session) {
// //         // User authenticated successfully
// //         console.log('Authentication successful', session);
// //         var accessToken = session.getAccessToken().getJwtToken();
// //         var idToken = session.getIdToken().getJwtToken();
// //         var refreshToken = session.getRefreshToken().getToken();

// //         console.log('Access Token:', accessToken);
// //         console.log('ID Token:', idToken);
// //         console.log('Refresh Token:', refreshToken);
// //     },
// //     onFailure: function (err) {
// //         // Handle authentication failure
// //         console.error('Authentication failed', err);
// //     },
// // });

// //   AWS.config.region = 'us-east-1';  // replace with your AWS region
// //   AWS.config.credentials = new AWS.CognitoIdentityCredentials({
// //       IdentityPoolId: 'us-east-1_zh8H4WxGm',  // replace with your Cognito Identity Pool ID
// //   });
// //   console.log(AWS.CognitoIdentityCredentials.CognitoUserPool)
// //   console.log(AWS)


// //   var poolData = {
// //     UserPoolId: 'us-east-1_zh8H4WxGm', 
// //     ClientId: '7vel4nc12cbipbvn366jdbc1h1',   
// // };

// //   var userPool = new AWS.AmazonCognitoIdentity.CognitoUserPool(poolData);
// //   var usuarioActual = userPool.getCurrentUser();

//   // const userPool = new AWS.CognitoUserPool('us-east-1_zh8H4WxGm');

//   // // Utilizar las funciones de Cognito para verificar la autenticación
//   // const usuarioActual = userPool.getCurrentUser();

//   if (usuarioActual) {
//     // Verifica la sesión actual del usuario
//     usuarioActual.getSession((err, session) => {
//       if (err) {
//         console.error(err);
//         return;
//       }

//       // El usuario está autenticado, redirige a foro.html
//       window.location.href = 'https://d1i2ps8v0vw7sh.cloudfront.net/foro.html';
//     });
//   } else {
//     // El usuario no está autenticado, redirige al login de Cognito
//     window.location.href = 'https://dominioparacrearusuarios12345.auth.us-east-1.amazoncognito.com/login?client_id=7vel4nc12cbipbvn366jdbc1h1&response_type=code&scope=email+openid&redirect_uri=https%3A%2F%2Fd1i2ps8v0vw7sh.cloudfront.net%2Fforo.html';
//   }
// }

// // Agregar el evento de clic al botónForo
// //document.getElementById('botonForo').addEventListener('click', verificarAutenticacion);

// document.addEventListener('DOMContentLoaded', verificarAutenticacion); </script>

    <script>
        function verificarAutenticacion2() {
            const urlParams = new URLSearchParams(window.location.search);
            const codeParam = urlParams.get('code');

            if (codeParam && /^\d+$/.test(codeParam)) {
                // El usuario está autenticado, permite el acceso a foro.html
                console.log('Usuario autenticado');
            } else {
                // El usuario no está autenticado o el código no es válido,
                // redirige a la página de inicio de sesión
                window.location.href = 'https://dominioparacrearusuarios12345.auth.us-east-1.amazoncognito.com/login?client_id=7u525asb2pf0q0fud6fh1hn5n7&response_type=code&scope=email+openid&redirect_uri=https%3A%2F%2Fd1i2ps8v0vw7sh.cloudfront.net%2Flogin.html';

            }
        }

        // Llama a la función al cargar la página
        window.addEventListener('load', verificarAutenticacion2);
    </script>

<script>
    function verificarAutenticacion2() {
        const urlParams = new URLSearchParams(window.location.search);
        const codeParam = urlParams.get('code');

        if (codeParam && /^\d+$/.test(codeParam)) {
            // El usuario está autenticado, permite el acceso a foro.html
            console.log('Usuario autenticado');
        } else {
            // El usuario no está autenticado o el código no es válido,
            // redirige a la página de inicio de sesión
            window.location.href =  'https://dominioparacrearusuarios12345.auth.us-east-1.amazoncognito.com/login?client_id=7vel4nc12cbipbvn366jdbc1h1&response_type=code&scope=email+openid&redirect_uri=https%3A%2F%2Fd1i2ps8v0vw7sh.cloudfront.net%2Fforo.html';

        }
    }

    // Llama a la función al cargar la página
    window.addEventListener('load', verificarAutenticacion2);
</script>

</html>




</html>


